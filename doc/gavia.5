.\" $Id: gavia.5,v 1.12 2006-04-17 20:59:00 grahn Exp $
.\" 
.\"
.TH gavia 5 "MAR 2006" Gavia "User Manuals"
.
.
.
.SH "NAME"
gavia \- Gavia bird notebook formats
.
.SH "DESCRIPTION"
Two different file formats are used with Gavia:
the text format tentatively called \(lqgab\(rq, and
the older, binary format \(lqLanius book\(rq.
Different Gavia commands work on different kinds of
files.
.
.
.
.SH "GAB FILES"
The \(lqGab\(rq input format is designed so that
a user can start with a template file
and quickly edit it, marking the species
seen during an excursion
and filling in any extra information.
.LP
Blank lines are ignored.
Comment lines (prefixed with a hash (#) sign)
are ignored.
Case and extra blank space
is not significant except in species names
(which are by convention in all lowercase)
and user-supplied data.
.LP
Input is line-oriented with
.IR continuations .
That is, fields may only be broken into several lines if line two, three and so on
are indented with blankspace.
This line break plus indentation is treated as a single space.
Thus, these two fragments are equivalent:
.IP
.nf
.ft CW
place: M\(:ossebergsparken,
       Djurparken,
       \(oAngermanland
date : 20060216

place: M\(:ossebergsparken, Djurparken, \(oAngermanland
date : 20060216
.fi
.LP
The input consists of a series of excursions,
each looking like
.IP
.nf
.ft CW
{
excursion fields
}{
species fields
}
.fi
.LP
Excursion fields are
.IP
.nf
.ft CW
Place: <place description>
Date: <yyyymmdd>
Time: <description of time out>
Observers: <names of any persons involved>
Weather: <weather description>
Comments: <anything else you want to note>
.fi
.LP
All but place and date are optional and
can be left unfilled or left out entirely.
Except for the date, the exact rules for the fields
(e.g. what format should the time have?)
are up to local conventions.
.LP
Species fields have the format
.IP
.ft CW
<species name>: <mark>: <number of individuals>: <comment>
.LP
The species name must be exactly one of those defined by Gavia
(i.e. the file
.IR lib/gavia/species ).
.LP
A species field can be unfilled (neither mark, number nor comment),
in which case that species
is not to be regarded as included in the excursion.
The only purpose of the mark (typically a `#') is to include species
without giving the number of individuals or a comment.
.LP
An empty number-of-individuals field is equivalent with one
set to `0'; both mean
\(lqthe species was seen, but in unspecified numbers\(rq.
.
.
.
.SH "LANIUS BOOK"
The binary Lanius book format was inherited by Gavia from its
Commodore-Amiga-based predecessor.
.LP
Integer values are stored in big-endian (network) byteorder.
Strings are encoded in the
.BR ISO_8859-1 (7)
charset.
They start with a two-octet, MSB first length and are not NUL-terminated.
.LP
The book itself consists of a preamble, the string
.IP
.ft CW
Lanius Book v1.0
.LP
followed by zero or more excursion records and terminated by
the string
.IP
.ft CW
NIL:
.LP
A excursion record consists of the sequence:
.IP \(bu 2m
An empty string.
.IP \(bu
Place (string).
.IP \(bu
Date, in seconds since Jan 1, 1978 00:00:00, as a 4-octet integer.
Considering the Amiga's system clock always lives in local time
(including DST) this is obviously not a good way to encode dates.
.IP \(bu
Time (string).
.IP \(bu
Observers (string).
.IP \(bu
Weather (string).
.IP \(bu
Comments (string).
.IP \(bu
An empty string.
.IP \(bu
A 200-octet bitmap identifying the birds seen,
arranged so that MSB of the first octet represents the first bird,
LSB represents the eighth bird, and so on.
Undefined positions are zeroed.
The mapping from number to species name, defined by
the file
.I lib/gavia/species
in a Gavia installation,
is guaranteed never to change (although new species will be added
and existing species may have their names changed,
or maybe translated to some language other than Swedish).
.IP \(bu
For each species marked in the bitmap, a two-octet
count of individuals. A zero means no count was given,
.I not
no individuals.
.IP \(bu
For each species marked in the bitmap, a comment
string.
.
.
.SH "AUTHOR"
J\(:orgen Grahn \fI<grahn+src@snipabacken.dyndns.org>
.
.
.SH "SEE ALSO"
.BR gavia (1)
